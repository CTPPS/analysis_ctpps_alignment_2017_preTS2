#!/bin/bash

#runs=(
# "297050"
# "297056"
# "297057"
# "297100"
# "297101"
# "297114"
# "297175"
# "297176"
# "297177"
# "297178"
# "297215"
# "297218"
# "297219"
# "297224"
# "297225"
# "297227"
# "297292"
# "297293"
# "297296"
# "297308"
# "297411"
# "297425"
# "297426"
# "297429"
# "297430"
# "297467"
# "297468"
# "297469"
# "298996"
# "298997"
# "299000"
# "299042"
# "299061"
# "299062"
# "299064"
# "299065"
# "299067"
# "299096"
# "299149"
# "299178"
# "299180"
# "299184"
# "299185"
# "299327"
# "299329"
# "299368"
# "299369"
# "299370"
# "299380"
# "299381"
# "299394"
# "299395"
# "299396"
# "299420"
# "299443"
# "299450"
# "299480"
# "299481"
# "299593"
# "299594"
# "299595"
# "299597"
# "299649"
# "300087"
# "300107"
# "300122"
# "300123"
# "300155"
# "300156"
# "300157"
# "300226"
# "300233"
# "300234"
# "300235"
# "300236"
# "300237"
# "300238"
# "300239"
# "300240"
# "300280"
# "300281"
# "300282"
# "300283"
# "300284"
# "300365"
# "300366"
# "300367"
# "300368"
# "300369"
# "300370"
# "300371"
# "300372"
# "300373"
# "300374"
# "300375"
# "300389"
# "300390"
# "300391"
# "300392"
# "300393"
# "300394"
# "300395"
# "300396"
# "300397"
# "300398"
# "300399"
# "300400"
# "300401"
# "300459"
# "300461"
# "300462"
# "300463"
# "300464"
# "300466"
# "300467"
# "300497"
# "300514"
# "300515"
# "300516"
# "300517"
# "300558"
# "300560"
# "300574"
# "300575"
# "300576"
# "300631"
# "300632"
# "300633"
# "300635"
# "300636"
# "300674"
# "300675"
# "300676"
# "300742"
# "300777"
# "300780"
# "300806"
# "300811"
# "300812"
# "300816"
# "300817"
# "301161"
# "301165"
# "301180"
# "301183"
# "301281"
# "301283"
# "301298"
# "301323"
# "301330"
# "301359"
# "301384"
# "301391"
# "301392"
# "301393"
# "301396"
# "301397"
# "301398"
# "301399"
# "301417"
# "301472"
# "301475"
# "301476"
# "301519"
# "301524"
# "301529"
# "301530"
# "301531"
# "301532"
# "301567"
# "301627"
# "301664"
# "301665"
# "301694"
# "301912"
# "301913"
# "301914"
# "301941"
# "301959"
# "301960"
# "301970"
# "301984"
# "301985"
# "301986"
# "301987"
# "301997"
# "301998"
# "302019"
# "302029"
# "302031"
# "302033"
# "302034"
# "302037"
# "302038"
# "302040"
# "302041"
# "302042"
# "302043"
# "302131"
# "302159"
# "302163"
# "302165"
# "302225"
# "302228"
# "302229"
# "302240"
# "302262"
# "302263"
# "302277"
# "302279"
# "302280"
# "302322"
# "302328"
# "302337"
# "302342"
# "302343"
# "302344"
# "302350"
# "302388"
# "302392"
# "302393"
# "302448"
# "302472"
# "302473"
# "302474"
# "302475"
# "302476"
# "302479"
# "302484"
# "302485"
# "302492"
# "302493"
# "302494"
# "302509"
# "302513"
# "302523"
# "302525"
# "302526"
# "302548"
# "302551"
# "302553"
# "302554"
# "302555"
# "302572"
# "302573"
# "302596"
# "302597"
# "302634"
# "302635"
# "302651"
# "302654"
# "302661"
# "302663"
#)

#1
#runs=(
# "302042"
# "302043"
# "302131"
# "302159"
# "302163"
# "302165"
# "302225"
# "302228"
# "302229"
# "302240"
# "302262"
# "302263"
# "302277"
# "302279"
#)

#2
#runs=(
# "302280"
# "302322"
# "302328"
# "302337"
# "302342"
# "302343"
# "302344"
# "302350"
# "302388"
# "302392"
# "302393"
# "302448"
# "302472"
# "302473"
#)

# 3
#runs=(
# "302474"
# "302475"
# "302476"
# "302479"
# "302484"
# "302485"
# "302492"
# "302493"
# "302494"
# "302509"
# "302513"
# "302523"
# "302525"
# "302526"
#)

#4
runs=(
 "302548"
 "302551"
 "302553"
 "302554"
 "302555"
 "302572"
 "302573"
 "302596"
 "302597"
 "302634"
 "302635"
 "302651"
 "302654"
 "302661"
 "302663"
)

patterns=(
	"/SingleMuon/Run2017B-17Nov2017-v1/MINIAOD"
	"/SingleMuon/Run2017C-17Nov2017-v1/MINIAOD"
	"/SingleMuon/Run2017D-17Nov2017-v1/MINIAOD"

	"/DoubleEG/Run2017B-17Nov2017-v1/MINIAOD"
	"/DoubleEG/Run2017C-17Nov2017-v1/MINIAOD"
	"/DoubleEG/Run2017D-17Nov2017-v1/MINIAOD"

	"/ZeroBias/Run2017B-17Nov2017-v1/MINIAOD"
	"/ZeroBias/Run2017C-17Nov2017-v1/MINIAOD"
	"/ZeroBias/Run2017D-17Nov2017-v1/MINIAOD"
)

#----------------------------------------------------------------------------------------------------

function ProcessOne()
{
	local run="$1"

	local log="run_$run"
	rm -f "$log"
	touch "$log"

	for pattern in ${patterns[*]}
	do
		das_client --query "dataset dataset=$pattern run=$run" --limit=0 >> "$log"
	done
}

#----------------------------------------------------------------------------------------------------

for run in ${runs[*]}
do
	ProcessOne $run
done
